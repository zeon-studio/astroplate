---
import { Image } from "astro:assets";

const {
  src,
  alt,
  width,
  height,
  format,
  class: className,
  style,
} = Astro.props;

// 检查 src 是否是有效路径（非空，非 undefined，非 null）
const isValidSrc = src && String(src).trim() !== '';

// 如果路径无效或路径指向 SVG（SVG 不需要 Image 组件处理），则使用 img 标签
const useImageTag = !isValidSrc || String(src).endsWith(".svg"); 
---

{
  // 如果路径无效或图片是 SVG，则使用标准的 <img> 标签
  useImageTag ? (
    <img
      src={src}
      alt={alt}
      width={width}
      height={height}
      class={className}
      style={style}
      decoding="async"
      loading="lazy"
    />
  ) : (
    // 否则，使用 Astro 的 <Image> 组件进行优化
    <Image
      src={src}
      alt={alt}
      width={width}
      height={height}
      format={format}
      class={className}
      style={style}
    />
  )
}
